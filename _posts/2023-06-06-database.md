---

title : "database learning notes"

published : false

---


### 传统数据库 (MySQL / Oracle) 的事务模型

#### 事务 (Transaction)
事务是数据库中的一个操作单元，要么全部执行成功，要么全部失败回滚。  
目标：保证数据的 **一致性 (Consistency)**。

---

#### ACID 特性
1. **原子性 (Atomicity)**  
   - 事务中的所有操作要么全部完成，要么全部不做。  
   - 例如：银行转账，扣钱和加钱必须同时成功。  
   - 实现方式：通过 *日志 (undo log)* 回滚未完成操作。
2. **一致性 (Consistency)**  
   - 事务前后，数据库必须保持一致的规则。  
   - 如：转账后，总金额不变。  
   - 数据库通过约束（主键、外键、触发器）保证。
3. **隔离性 (Isolation)**  
   - 多个事务并发执行时，相互之间不影响。  
   - 由 **隔离级别** 决定：
     - Read Uncommitted（读未提交）  
     - Read Committed（读已提交）  
     - Repeatable Read（可重复读，MySQL 默认）  
     - Serializable（可串行化，最高级别）  
   - 实现方式：**锁 (Lock)** 和 **MVCC**。
4. **持久性 (Durability)**  
   - 事务提交后，数据永久保存，即使断电或宕机。  
   - 实现方式：写入 *redo log* 并持久化到磁盘。

---

#### MySQL vs Oracle
- **MySQL (InnoDB 引擎)**  
  - 默认隔离级别：Repeatable Read  
  - MVCC（多版本并发控制）+ 行锁  
  - Binlog + Redo Log + Undo Log 实现事务恢复  
- **Oracle**  
  - 默认隔离级别：Read Committed  
  - 更强大的事务恢复机制  
  - 广泛应用于金融、电信等核心系统  

---

#### 学习方法
1. **理论学习**  
   - 阅读 MySQL InnoDB 文档  
   - 学习 Oracle 事务控制 (COMMIT, ROLLBACK, SAVEPOINT)  
2. **实验**  
   - 在 MySQL 中开两个事务，测试脏读、幻读、不可重复读  
   - 使用 `SET TRANSACTION ISOLATION LEVEL` 调整隔离级别  
3. **进阶**  
   - 研究 WAL (Write Ahead Logging)  
   - 研究 MySQL 5.7 / 8.0 事务实现源码  

---

### 涉及职业
- **数据库管理员 (DBA)**：管理事务日志、调优性能  
- **后端开发工程师**：在业务代码中正确使用事务  
- **金融/支付工程师**：保证跨表、跨库的事务一致性  
- **研究人员**：研究分布式事务与单机事务模型的结合  

---